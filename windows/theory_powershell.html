<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-05b8c18cdbe0b397.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-2043948c1246ba90.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9538641435026bd3.js" defer=""></script><script src="/_next/static/chunks/pages/windows/theory_powershell-3da301b33bf8e9ae.js" defer=""></script><script src="/_next/static/IieJqtKbImurzCcUpjyv7/_buildManifest.js" defer=""></script><script src="/_next/static/IieJqtKbImurzCcUpjyv7/_ssgManifest.js" defer=""></script></head><body><div id="__next"><h1>Windows: Powershell</h1>
<h2>Как работать?</h2>
<ul>
<li>Оболочка</li>
<li>Среда для написания сценариев ISE</li>
</ul>
<h2>Помощь</h2>
<p>Командлет --- это команды в PowerShell:</p>
<ul>
<li><code>Get-Help</code></li>
<li><code>Get-Help -Full</code></li>
<li><code>Get-Help -Online</code></li>
<li><code>Get-Help -Detail</code></li>
<li><code>Get-Help -Examples</code></li>
</ul>
<p>Алиасы --- это псевдонимы для командлетов:</p>
<ul>
<li><code>Get-Command</code> --- перечень командлетов, функций и алиасов</li>
<li><code>Get-Command -CommandType Alias</code></li>
<li><code>Set-Alias</code> --- создать алиас</li>
</ul>
<p>Элементы языка --- регистронезависимые.</p>
<h2>Работа с файлами</h2>
<ul>
<li><code>Get-ChildItem</code>, <code>dir</code>, <code>ls</code>, <code>gci</code> --- перечень файлов и каталогов</li>
<li><code>Get-Location</code>, <code>pwd</code>, <code>gl</code> --- получить каталог</li>
<li><code>Set-Location</code>, <code>cd</code>, <code>chdir</code>, <code>sl</code> --- сменить каталог</li>
<li><code>Copy-Item</code>, <code>copy</code>, <code>cp</code>, <code>cpi</code> --- копирование файлов / каталогов</li>
<li><code>Move-Item</code>, <code>mi</code>, <code>move</code>, <code>mv</code> --- перемещение файлов / каталогов</li>
<li><code>Remove-Item</code>, <code>del</code>, <code>erase</code>, <code>rd</code>, <code>ri</code>, <code>rm</code>, <code>rmdir</code> --- удаление файлов / каталогов</li>
<li><code>Rename-Item</code>, <code>ri</code>, <code>ren</code> --- переименование файлов / каталогов</li>
<li><code>New-Item</code>, <code>ni</code> --- создание файлов / каталогов</li>
<li><code>Get-Content</code> --- печать содержимого текстового файла</li>
<li><code>Add-Content</code> --- добавить в текстового файл содержимое</li>
<li><code>Set-Content</code> --- заменить в текстового файл содержимое</li>
</ul>
<ol>
<li>Создать каталог (<code>New-Item</code>)</li>
<li>Войти в каталог</li>
<li>Создать пустой файл</li>
<li>Переименовать файл</li>
<li>Скопируйте файл</li>
<li>Удалите все созданные файлы и каталоги</li>
</ol>
<h2>Скрипты</h2>
<p>Скрипты имеют расширение &quot;.PS1&quot;</p>
<p>Если политика выполнения скриптов:</p>
<ul>
<li><code>Restricted</code>, cкрипты не выполняются</li>
<li><code>AllSigned</code>, все скрипты должны иметь цифровую подпись</li>
<li><code>RemoteSigned</code>, чужие скрипты должны иметь цифровую подпись</li>
<li><code>Unresticted</code>, все скрипты выполняются</li>
</ul>
<p><code>Get-ExecutionPolicy</code> --- получение политики</p>
<p><code>Set-ExecutionPolicy</code> --- изменение политики, нужны права администратора (имикиц428)</p>
<p><code>Get-Help about_Execution_Policies</code> --- помощь по политике исполнения</p>
<h2>Работа с процессами</h2>
<ul>
<li><code>Get-Process</code> --- информация о процессах</li>
<li><code>Stop-Process</code> --- остановка процесса</li>
<li><code>Get-Service</code> --- информация о службах</li>
<li><code>New-Service</code> --- создать новую службу</li>
<li><code>Restart-Service</code> --- перезапустить службу</li>
<li><code>Resume-Service</code> --- возобновить работу службы</li>
<li><code>Set-Service</code> --- изменить службу</li>
<li><code>Start-Service</code> --- запустить службу</li>
<li><code>Stop-Service</code> --- остановить службу</li>
<li><code>Suspend-Service</code> --- приостановить службу</li>
</ul>
<hr/>
<h2>Установка и удаление компонентов Windows</h2>
<ul>
<li><code>Get-WindowsFeature</code> --- перечень доступных компонент (ролей) Windows</li>
<li><code>Install-WindowsFeature</code> --- установить компоненту (роль) Windows</li>
<li><code>Uninstall-WindowsFeature</code> --- удалить компоненту (роль) Windows</li>
</ul>
<hr/>
<h2>Конвейеры</h2>
<p>PowerShell тесно интегрирован с .NET Framework</p>
<p>PowerShell в отличие от Cmd, Bash и других оболочек оперирует объектами</p>
<p><code>Select-Object</code> --- выбор свойств объектов</p>
<p><code>Where-Object</code>, <code>?</code>, <code>where</code> --- фильтрация объектов по условию</p>
<p><code>Export-CSV</code> --- вывод в таблицу CSV</p>
<p><code>ConvertTo-HTML</code> --- конвертировать результат в HTML</p>
<p>Примеры:</p>
<pre><code class="language-powershell">  Get-Process | Where-Object {$_.ProcessName -match &#x27;^p.*&#x27;}
</code></pre>
<pre><code class="language-powershell">  Get-Process | where {$_.ProcessName -like &#x27;*power*&#x27;} | ConvertTo-Html
</code></pre>
<pre><code class="language-powershell">  Get-Process | ? {$_.ProcessName -eq &#x27;iexplore&#x27;} | Stop-Process
</code></pre>
<h2>Синтаксические конструкции</h2>
<p>Однострочный комментарий</p>
<pre><code class="language-powershell">
  &lt;#
    Многострочный комментарий
  #&gt;
</code></pre>
<p>Цикл <code>For</code>:</p>
<pre><code class="language-powershell">
  For ($i = 0; $i -lt 10; $i++)
  {
      If ($i % 2 -eq 0)
      {
          Write-Output &quot;Чет: $i&quot;
      }
      ElseIf ($i % 3 -eq 0)
      {
          Write-Output &quot;Делится на 3: $i&quot;
      }
      Else
      {
          Write-Output &quot;Что-то другое: $i&quot;
      }
      $i++
  }
</code></pre>
<p>Цикл <code>While</code>:</p>
<pre><code class="language-powershell">
  $i = 0
  While ($i -lt 10)
  {
      If ($i % 2 -eq 0)
      {
          Write-Output &quot;Чет: $i&quot;
      }
      ElseIf ($i % 3 -eq 0)
      {
          Write-Output &quot;Делится на 3: $i&quot;
      }
      Else
      {
          Write-Output &quot;Что-то другое: $i&quot;
      }
      $i++
  }
</code></pre>
<p>Цикл <code>ForEach</code>:</p>
<pre><code class="language-powershell">
  function test($i)
  {
      return &quot;Hello $i&quot;
  }
  foreach ($file in Get-ChildItem)
  {
      test($file.Name)
  }
</code></pre>
<p>Работа с функциями:</p>
<pre><code class="language-powershell">
  function fact($i)
  {
      if ($i -eq 1)
      {
          return 1
      }
      else
      {
          $a = fact($i-1)
          return $i * $a
      }
  }
  fact(20)
</code></pre>
<p>Ветвление:</p>
<pre><code class="language-powershell">
  $dow = &quot;Friday&quot;
  switch ($dow) {
    &quot;Friday&quot; {
      &quot;Day is Friday&quot;
    }
    &quot;Tuesday&quot; {
      &quot;Day is Tuesday&quot;
    }
    &quot;Friday&quot; {
      &quot;Day is Friday&quot;
    }
  }
</code></pre>
<p>Циклы с постусловием:</p>
<pre><code class="language-powershell">
  do {
    statement_list
  } while (conditional_expression)

```powershell

  do {
    statement_list
  } until (conditional_expression)
</code></pre></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/windows/theory_powershell","query":{},"buildId":"IieJqtKbImurzCcUpjyv7","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>